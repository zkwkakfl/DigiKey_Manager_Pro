# 디지키 파트넘버 조회 프로그램 v1.2.4

디지키 API를 사용하여 엑셀 파일의 파트넘버를 조회하는 GUI 애플리케이션입니다.

## 버전 1.2.4 주요 기능

### 새로운 기능 (v1.2.4)

8. **조회 진행 상황 표시 (신규)**
   - 조회 중인 파트넘버의 전체 개수와 조회 완료 개수를 실시간으로 표시합니다.
   - 진행률 바를 통해 조회 진행 상황을 시각적으로 확인할 수 있습니다.
   - "조회 진행: X / Y개" 형식으로 명확한 진행 상황을 제공합니다.

9. **조회 실패 파트넘버 웹 검색 링크 (신규)**
   - 조회가 실패한 파트넘버의 상세정보에 디지키 웹사이트 검색 링크를 자동으로 추가합니다.
   - 링크를 클릭하면 디지키 웹사이트에서 해당 파트넘버를 검색할 수 있습니다.
   - API로 조회되지 않은 파트넘버도 웹에서 직접 확인할 수 있습니다.

### 이전 버전 기능 (v1.2.3)

7. **조회 실패 파트넘버 캐싱**
   - 디지키에서 조회되지 않는 파트넘버도 DB에 저장합니다.
   - 같은 파트넘버를 반복적으로 API 조회하는 것을 방지합니다.
   - API 호출 횟수를 더욱 절약할 수 있습니다.
   - 조회 실패 이력도 DB에 보관되어 관리가 용이합니다.

### 이전 버전 기능 (v1.2.2)

6. **URL 링크 클릭 기능**
   - 상세정보 패널에서 URL을 클릭하여 웹사이트로 바로 이동할 수 있습니다.
   - 제품 상세정보 URL 클릭 시 디지키 제품 페이지가 열립니다.
   - 데이터시트 URL 클릭 시 데이터시트 PDF가 열립니다.
   - 마우스 오버 시 커서가 손 모양으로 변경되어 클릭 가능함을 표시합니다.

### 이전 버전 기능 (v1.2.1)

5. **API 호출 횟수 추적**
   - 오늘 API 호출 횟수를 실시간으로 추적합니다.
   - 일일 호출 한도(1,000회) 대비 남은 호출 횟수를 표시합니다.
   - 상단 툴바에 API 호출 현황이 실시간으로 표시됩니다.
   - 최근 30일간의 API 호출 이력을 확인할 수 있습니다. (`도구 > API 호출 통계`)

### 이전 버전 기능 (v1.2)

4. **데이터베이스 캐싱**
   - 조회한 파트넘버 정보를 SQLite 데이터베이스에 자동 저장합니다.
   - 이미 조회한 파트넘버는 데이터베이스에서 즉시 불러옵니다.
   - v1.2.3부터는 조회 실패한 파트넘버도 저장하여 중복 조회를 방지합니다.
   - API 호출 횟수를 대폭 절감하여 속도 향상 및 API 제한 회피가 가능합니다.
   - 데이터베이스 통계 조회 기능 (`도구 > 데이터베이스 통계`)

## 기본 기능

1. **엑셀 파일 로드 및 시트 선택**
   - 엑셀 파일(.xlsx, .xls)을 열고 시트를 선택할 수 있습니다.
   - 선택한 시트의 데이터를 리스트뷰로 표시합니다.

2. **파트넘버 조회**
   - 시트 데이터에서 파트넘버 컬럼을 더블클릭하면, 해당 행부터 아래로 순환하며 파트넘버를 조회합니다.
   - Row, 파트넘버, 제조업체, 마운팅타입 정보를 조회 결과 탭에 표시합니다.
   - DB 조회 및 API 호출 통계를 실시간으로 확인할 수 있습니다.

3. **상세정보 확인**
   - 조회 결과에서 항목을 더블클릭하면 상세 정보가 오른쪽 패널에 표시됩니다.
   - 데이터 출처(Database 또는 API)를 확인할 수 있습니다.

## 설치 방법

### 1. 필수 패키지 설치

```bash
pip install -r requirements.txt
```

### 2. 디지키 API 인증 정보 설정

1. [디지키 개발자 포털](https://developer.digikey.com/)에서 계정을 생성하고 애플리케이션을 등록합니다.
2. Client ID와 Client Secret을 받습니다.
3. 프로그램 실행 후 `설정 > 디지키 API 설정` 메뉴에서 인증 정보를 입력합니다.

## 사용 방법

1. 프로그램 실행
   ```bash
   python main.py
   ```

2. 엑셀 파일 열기
   - `파일 > 엑셀 파일 열기` 메뉴를 선택하거나 툴바의 "엑셀 파일 열기" 버튼을 클릭합니다.
   - 열고 싶은 엑셀 파일을 선택합니다.

3. 시트 선택
   - 파일을 연 후 "시트 선택" 버튼을 클릭하여 사용할 시트를 선택합니다.

4. 파트넘버 조회
   - 시트 데이터 탭에서 파트넘버가 있는 행을 더블클릭합니다.
   - 프로그램이 자동으로 해당 행부터 아래로 순환하며 파트넘버를 조회합니다.
   - 조회 결과는 자동으로 "조회 결과" 탭으로 전환되어 표시됩니다.

5. 상세정보 확인
   - 조회 결과 탭에서 원하는 항목을 더블클릭하면 오른쪽에 상세 정보가 표시됩니다.

6. API 호출 현황 확인 (v1.2.1)
   - 상단 툴바에서 오늘의 API 호출 현황을 실시간으로 확인할 수 있습니다.
   - `도구 > API 호출 통계` 메뉴에서 상세한 통계와 이력을 확인할 수 있습니다.

7. URL 링크 클릭 (v1.2.2)
   - 조회 결과의 상세정보 패널에서 URL 링크를 클릭하여 웹사이트에 접근할 수 있습니다.
   - 제품 상세정보와 데이터시트를 바로 확인할 수 있습니다.

## 프로젝트 구조

```
.
├── main.py              # 메인 GUI 애플리케이션
├── excel_handler.py     # 엑셀 파일 처리 모듈
├── digikey_api.py       # 디지키 API 클라이언트 모듈
├── database.py          # SQLite 데이터베이스 핸들러 (v1.2 신규)
├── requirements.txt     # 필수 패키지 목록
├── parts_cache.db       # 파트넘버 캐시 데이터베이스 (자동 생성)
└── README.md           # 사용 설명서
```

## 데이터베이스 구조

### 파트넘버 정보 테이블 (parts)

- **part_number** (TEXT, PRIMARY KEY): 파트넘버
- **manufacturer** (TEXT, NOT NULL): 제조사
- **mounting_type** (TEXT, NOT NULL): 장착유형
- **description** (TEXT): 제품 설명
- **product_url** (TEXT): 제품 URL
- **datasheet_url** (TEXT): 데이터시트 URL
- **quantity_available** (INTEGER): 재고량
- **unit_price** (REAL): 단가
- **created_at** (TIMESTAMP): 생성일시
- **updated_at** (TIMESTAMP): 수정일시

### API 호출 통계 테이블 (api_calls) - v1.2.1 신규

- **id** (INTEGER, PRIMARY KEY): 고유 ID
- **call_date** (DATE, UNIQUE): 호출 날짜
- **call_count** (INTEGER): 호출 횟수

## 주의사항

- 디지키 API Product Information API는 일일 호출 제한이 1,000회입니다.
- v1.2부터는 데이터베이스 캐싱으로 API 호출 횟수를 크게 줄일 수 있습니다.
- v1.2.1부터는 API 호출 현황을 실시간으로 모니터링할 수 있습니다.
- v1.2.3부터는 조회 실패한 파트넘버도 DB에 저장하여 중복 조회를 방지합니다.
- v1.2.4부터는 조회 진행 상황을 실시간으로 확인할 수 있으며, 조회 실패한 파트넘버는 웹 검색 링크를 통해 확인할 수 있습니다.
- 샌드박스 환경을 사용하는 경우 실제 제품 데이터가 아닐 수 있습니다.
- 엑셀 파일의 파트넘버 컬럼명은 "Part Number", "PartNumber", "Part" 등으로 인식할 수 있습니다.
- 데이터베이스 파일(parts_cache.db)은 프로그램 실행 폴더에 자동으로 생성됩니다.
- API 호출 통계는 매일 자정을 기준으로 리셋됩니다.
- 조회 실패로 저장된 파트넘버를 재조회하려면 DB에서 해당 항목을 삭제하면 됩니다.
- 조회 실패한 파트넘버의 웹 검색 링크는 디지키 웹사이트의 검색 결과 페이지로 연결됩니다.

## 문제 해결

### API 인증 오류
- Client ID와 Client Secret이 올바른지 확인하세요.
- 디지키 개발자 포털에서 애플리케이션이 활성화되어 있는지 확인하세요.

### 파트넘버 조회 실패
- 엑셀 파일에 파트넘버 컬럼이 있는지 확인하세요.
- 파트넘버가 올바른 형식인지 확인하세요.
- API 호출 제한에 걸리지 않았는지 확인하세요.

## 라이선스

이 프로젝트는 개인 사용 목적으로 제작되었습니다.
